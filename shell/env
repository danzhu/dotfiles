# -*- mode: sh -*-

has() {
    type "$1" &> /dev/null
}

first() {
    for prog in "$@"; do
        if has "$prog"; then
            echo "$prog"
            break;
        fi
    done
}

eval "$(dircolors -b)"
# export QT_FONT_DPI=240

if has emacs; then
    export EDITOR='emacsclient --tty'
    export GEDITOR='emacsclient --create-frame'
    export ALTERNATE_EDITOR=''
elif has vim; then
    export EDITOR=vim
    if has gvim; then
        export GEDITOR=gvim
    fi
fi

if has rofi; then
    export RUNNER='rofi -show run'
    export LAUNCHER='rofi -show drun -show-icons'
else
    if has dmenu_run; then
        export RUNNER=dmenu_run
    fi
    if has dmenu && has i3-dmenu-desktop; then
        export LAUNCHER=i3-dmenu-desktop
    fi
fi

if has qt5ct; then
    export QT_QPA_PLATFORMTHEME=qt5ct
fi

if has fcitx; then
    export GTK_IM_MODULE=fcitx
    export QT_IM_MODULE=fcitx
    export XMODIFIERS=@im=fcitx
fi

export TERMINAL=$(first termite alacritty gnome-terminal konsole urxvt xterm)
export BROWSER=$(first chromium chromium-browser google-chrome firefox)
export MANAGER=$(first ranger dolphin)

if [[ -f $DOT/shell/env.local ]]; then
    source $DOT/shell/env.local
fi

unset -f has first

# vim: ft=sh
